(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8705,        210]
NotebookOptionsPosition[      7954,        179]
NotebookOutlinePosition[      8328,        195]
CellTagsIndexPosition[      8285,        192]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"ParallelEvaluate", "[", "$KernelID", "]"}]], "Input",
 CellChangeTimes->{{3.6502086800600834`*^9, 3.650208710266466*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{
  3.65020871163211*^9, 3.6502088092967377`*^9, 3.6502124017730627`*^9, 
   3.6502124441905923`*^9, 3.650212480536769*^9, 3.6502125489520164`*^9, 
   3.6502127891108117`*^9, 3.650212916240629*^9, {3.6502671858574553`*^9, 
   3.6502671950960464`*^9}, {3.6503423577515645`*^9, 3.6503423825289583`*^9}, 
   3.650545142224678*^9, {3.650546519637889*^9, 3.650546528445112*^9}, {
   3.650546565223091*^9, 3.650546590961509*^9}, {3.6505466292021904`*^9, 
   3.6505466355386662`*^9}, 3.6505466901572485`*^9, 3.6505467868981304`*^9, 
   3.6529742790116215`*^9, {3.65298051607952*^9, 3.6529805462911286`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParallelFactorial", "[", "x_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"list", "=", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"Range", "[", "x", "]"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DistributeDefinitions", "[", "list", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Apply", "[", 
       RowBox[{"Times", ",", "\[IndentingNewLine]", 
        RowBox[{"ParallelEvaluate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Times", ",", 
            RowBox[{"list", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
               RowBox[{"Floor", "[", 
                RowBox[{"x", "*", 
                 FractionBox[
                  RowBox[{"$KernelID", "-", "1"}], "$KernelCount"]}], "]"}], 
               "+", "1"}], ";;", 
              RowBox[{"Floor", "[", 
               RowBox[{"x", "*", 
                FractionBox["$KernelID", "$KernelCount"]}], "]"}]}], 
             "\[RightDoubleBracket]"}]}], "]"}], ",", 
          RowBox[{"Range", "[", "$KernelCount", "]"}]}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.650208831576844*^9, 3.6502088641623464`*^9}, {
   3.650209039169603*^9, 3.650209039839119*^9}, {3.650210188172966*^9, 
   3.6502102157136364`*^9}, {3.6502102532631197`*^9, 3.650210387598712*^9}, {
   3.650210432961241*^9, 3.650210494710332*^9}, {3.6502105619838457`*^9, 
   3.65021063046381*^9}, {3.65021066149706*^9, 3.6502106625332856`*^9}, {
   3.6502107046186285`*^9, 3.650210704728011*^9}, 3.650210734828845*^9, {
   3.6502110736168756`*^9, 3.6502111052936316`*^9}, {3.6502111543451757`*^9, 
   3.65021119924403*^9}, {3.6502117429148827`*^9, 3.6502117979921017`*^9}, {
   3.650212092146795*^9, 3.6502122369556427`*^9}, {3.650212478723474*^9, 
   3.650212496463625*^9}, {3.650212573340626*^9, 3.650212588629955*^9}, {
   3.6502127765556154`*^9, 3.6502127875660114`*^9}, {3.650212910036278*^9, 
   3.6502129145854673`*^9}, {3.6505451294921465`*^9, 
   3.6505451382829037`*^9}, {3.650545214856987*^9, 3.6505453047184725`*^9}, {
   3.6505453719061155`*^9, 3.650545404507162*^9}, {3.6505465472914248`*^9, 
   3.650546569013749*^9}, {3.652980717060649*^9, 3.652980720651039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyFactorial", "[", "n_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Apply", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"Range", "[", "n", "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.650267211978978*^9, 3.6502672651140394`*^9}, {
   3.6503422892598085`*^9, 3.6503423216561823`*^9}, 3.650342380950879*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"2000000", "!"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.650212256917098*^9, 3.6502123052784147`*^9}, {
   3.650212928182384*^9, 3.6502129438568745`*^9}, {3.6502130446329575`*^9, 
   3.6502130503449774`*^9}, 3.650213089443113*^9, 3.652974301493476*^9, {
   3.652980519633788*^9, 3.652980519744029*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.421875`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.6502122577346773`*^9, 3.6502123128451567`*^9}, 
   3.6502124018711247`*^9, 3.6502124446541977`*^9, 3.650212480879006*^9, 
   3.6502125492839165`*^9, 3.6502127894683027`*^9, {3.6502129163637204`*^9, 
   3.650212947906754*^9}, 3.6502130580073977`*^9, {3.65021309385256*^9, 
   3.65021311330445*^9}, {3.65026718618769*^9, 3.650267200176649*^9}, {
   3.6503423559333577`*^9, 3.6503423828149123`*^9}, 3.6505451426699934`*^9, {
   3.6505465199371014`*^9, 3.6505465287203045`*^9}, {3.6505465655443196`*^9, 
   3.6505465912723103`*^9}, {3.6505466295504355`*^9, 3.6505466358078566`*^9}, 
   3.6505466904559097`*^9, 3.65054678726439*^9, {3.652974279324115*^9, 
   3.652974302055925*^9}, {3.652980516317003*^9, 3.6529805467928967`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"ParallelFactorial", "[", "2000000", "]"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.6502112262364435`*^9, 3.6502112446524506`*^9}, {
   3.650211289668619*^9, 3.6502113193689995`*^9}, {3.6502113973118706`*^9, 
   3.650211397364908*^9}, {3.65021225482162*^9, 3.6502122607388067`*^9}, {
   3.6502122955535755`*^9, 3.6502123021382046`*^9}, {3.6502124328734183`*^9, 
   3.6502124409872427`*^9}, {3.650212925424241*^9, 3.6502129413730564`*^9}, {
   3.6502130410273952`*^9, 3.6502130486197586`*^9}, {3.6502130844254045`*^9, 
   3.6502130864848604`*^9}, 3.652974297224732*^9, {3.652980521802706*^9, 
   3.6529805219121065`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.375`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.6502112983611174`*^9, 3.650211319816308*^9}, 
   3.650211397808221*^9, {3.650212243434907*^9, 3.6502123127691174`*^9}, 
   3.6502124018661213`*^9, 3.650212444647192*^9, 3.650212480871004*^9, 
   3.6502125492762394`*^9, 3.650212789459798*^9, {3.6502129163537116`*^9, 
   3.6502129478306813`*^9}, 3.650213055896899*^9, {3.6502130935763636`*^9, 
   3.650213114439274*^9}, {3.6502671872444363`*^9, 3.6502672015295906`*^9}, {
   3.650342356011485*^9, 3.650342383863558*^9}, 3.65054514364268*^9, {
   3.6505465226640263`*^9, 3.6505465314032*^9}, {3.6505465682752476`*^9, 
   3.6505465923440666`*^9}, {3.650546630616188*^9, 3.650546636869607*^9}, 
   3.650546691529262*^9, 3.6505467883301415`*^9, {3.652974280369212*^9, 
   3.6529743081390333`*^9}, {3.652980517332339*^9, 3.6529805492209806`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"MyFactorial", "[", "2000000", "]"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.650342328772196*^9, 3.6503423499198074`*^9}, 
   3.6529743043554335`*^9, {3.652980524360535*^9, 3.6529805245011606`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.21875`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.650342356591814*^9, 3.650342384407072*^9}, 
   3.6505451442991433`*^9, {3.650546523266452*^9, 3.6505465319706078`*^9}, {
   3.650546568859643*^9, 3.6505465929284496`*^9}, {3.650546631198601*^9, 
   3.650546637429001*^9}, 3.6505466921036673`*^9, 3.650546788897543*^9, {
   3.6529742809548197`*^9, 3.6529743052799587`*^9}, {3.6529805178872952`*^9, 
   3.652980550469405*^9}}]
}, Open  ]]
},
WindowSize->{1920, 976},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
Magnification:>1.5 Inherited,
FrontEndVersion->"10.1 for Microsoft Windows (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 145, 2, 45, "Input"],
Cell[728, 26, 712, 11, 44, "Output"]
}, Open  ]],
Cell[1455, 40, 2412, 48, 294, "Input"],
Cell[3870, 90, 432, 10, 75, "Input"],
Cell[CellGroupData[{
Cell[4327, 104, 370, 7, 45, "Input"],
Cell[4700, 113, 832, 12, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5569, 130, 687, 11, 45, "Input"],
Cell[6259, 143, 894, 13, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7190, 161, 266, 5, 45, "Input"],
Cell[7459, 168, 479, 8, 44, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
